/**
 * Family Chart View Styles
 * Styles for the interactive family chart ItemView
 * Includes essential family-chart library styles
 */

/* ============================================================
 * View Container
 * ============================================================ */

.cr-family-chart-view {
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
}

/* ============================================================
 * Toolbar
 * ============================================================ */

.cr-fcv-toolbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--size-4-2) var(--size-4-3);
  border-bottom: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary);
  flex-shrink: 0;
  gap: var(--size-4-2);
}

.cr-fcv-toolbar-left,
.cr-fcv-toolbar-right {
  display: flex;
  align-items: center;
  gap: var(--size-4-2);
}

.cr-fcv-control-group {
  display: flex;
  align-items: center;
  gap: var(--size-4-1);
}

.cr-fcv-label {
  font-size: var(--font-ui-small);
  color: var(--text-muted);
}

.cr-fcv-select {
  font-size: var(--font-ui-small);
  padding: var(--size-4-1) var(--size-4-2);
  border-radius: var(--radius-s);
  border: 1px solid var(--background-modifier-border);
  background-color: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
}

.cr-fcv-select:hover {
  border-color: var(--background-modifier-border-hover);
}

.cr-fcv-select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 2px var(--background-modifier-border-focus);
}

.cr-fcv-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  padding: 0;
  border: none;
  border-radius: var(--radius-s);
  background: transparent;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.1s ease;
}

.cr-fcv-btn:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
}

.cr-fcv-btn:active {
  background-color: var(--background-modifier-active-hover);
}

.cr-fcv-btn svg {
  width: 18px;
  height: 18px;
}

/* Zoom Controls */
.cr-fcv-zoom-group {
  border-left: 1px solid var(--background-modifier-border);
  padding-left: var(--size-4-2);
  margin-left: var(--size-4-1);
}

.cr-fcv-zoom-btn {
  width: 24px;
  height: 24px;
}

.cr-fcv-zoom-btn svg {
  width: 16px;
  height: 16px;
}

.cr-fcv-zoom-level {
  font-size: var(--font-ui-smaller);
  color: var(--text-muted);
  min-width: 40px;
  text-align: center;
  user-select: none;
}

/* Toggle button active state */
.cr-fcv-btn.is-active {
  background-color: var(--background-modifier-hover);
  color: var(--interactive-accent);
}

/* Disabled button state */
.cr-fcv-btn[disabled] {
  opacity: 0.3;
  cursor: not-allowed;
  pointer-events: none;
}

/* ============================================================
 * Chart Container
 * ============================================================ */

.cr-fcv-chart-container {
  flex: 1;
  overflow: visible;
  position: relative;
  min-height: 0;
}

/* ============================================================
 * Empty State
 * ============================================================ */

.cr-fcv-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  padding: var(--size-4-8);
  text-align: center;
  color: var(--text-muted);
}

.cr-fcv-empty-state h3 {
  margin: 0 0 var(--size-4-2) 0;
  color: var(--text-normal);
  font-size: var(--font-ui-large);
}

.cr-fcv-empty-state p {
  margin: 0 0 var(--size-4-4) 0;
  max-width: 400px;
  line-height: 1.5;
}

.cr-fcv-empty-state__instructions {
  margin-bottom: var(--size-4-4);
  text-align: left;
}

.cr-fcv-empty-state__instructions p {
  margin-bottom: var(--size-4-2);
}

.cr-fcv-empty-state__instructions ul {
  margin: 0;
  padding-left: var(--size-4-6);
}

.cr-fcv-empty-state__instructions li {
  margin-bottom: var(--size-4-1);
  line-height: 1.5;
}

.cr-fcv-empty-state button {
  margin-top: var(--size-4-2);
}

.cr-fcv-empty-state__hint {
  margin-top: var(--size-4-4);
  padding: var(--size-4-2) var(--size-4-3);
  background-color: var(--background-secondary);
  border-radius: var(--radius-s);
  max-width: 400px;
}

/* ============================================================
 * family-chart Core Styles
 * Essential styles from family-chart library
 * ============================================================ */

.cr-fcv-chart-container.f3 {
  /* family-chart CSS variables - customizable via Style Settings plugin */
  --female-color: var(--cr-fcv-female-color, rgb(196, 138, 146));
  --male-color: var(--cr-fcv-male-color, rgb(120, 159, 172));
  --genderless-color: var(--cr-fcv-unknown-color, rgb(211, 211, 211));
  --background-color: var(--cr-fcv-background-dark, rgb(33, 33, 33));
  --text-color: var(--cr-fcv-text-dark, #fff);

  position: relative;
  display: flex;
  width: 100%;
  height: 100%;
  font-family: var(--font-interface), "Roboto", sans-serif;
  color: var(--text-color);
  background-color: var(--background-color);
}

.cr-fcv-chart-container.f3 * {
  box-sizing: border-box;
}

/* Main SVG container */
.cr-fcv-chart-container.f3 svg.main_svg {
  width: 100%;
  height: 100%;
}

.cr-fcv-chart-container.f3 svg.main_svg text {
  fill: currentColor;
}

/* Card gender colors - SVG cards */
.cr-fcv-chart-container.f3 rect.card-female,
.cr-fcv-chart-container.f3 .card-female .card-body-rect,
.cr-fcv-chart-container.f3 .card-female .text-overflow-mask {
  fill: var(--female-color);
}

.cr-fcv-chart-container.f3 rect.card-male,
.cr-fcv-chart-container.f3 .card-male .card-body-rect,
.cr-fcv-chart-container.f3 .card-male .text-overflow-mask {
  fill: var(--male-color);
}

.cr-fcv-chart-container.f3 .card-genderless .card-body-rect,
.cr-fcv-chart-container.f3 .card-genderless .text-overflow-mask {
  fill: var(--genderless-color);
}

/* Card add button */
.cr-fcv-chart-container.f3 .card_add .card-body-rect {
  fill: #3b5560;
  stroke-width: 4px;
  stroke: #fff;
  cursor: pointer;
}

.cr-fcv-chart-container.f3 g.card_add text {
  fill: #fff;
}

/* Main card outline */
.cr-fcv-chart-container.f3 .card-main-outline {
  stroke: currentColor;
  stroke-width: 3px;
}

/* Card transitions */
.cr-fcv-chart-container.f3 .card_family_tree rect {
  transition: 0.3s;
}

.cr-fcv-chart-container.f3 .card_family_tree:hover rect {
  transform: scale(1.1);
}

/* Cursor pointer for clickable elements */
.cr-fcv-chart-container.f3 .cursor-pointer {
  cursor: pointer;
}

/* Card add relative icons */
.cr-fcv-chart-container.f3 .card_add_relative {
  cursor: pointer;
  color: #fff;
  transition: 0.3s;
}

.cr-fcv-chart-container.f3 .card_add_relative circle {
  fill: rgba(0, 0, 0, 0);
}

.cr-fcv-chart-container.f3 .card_add_relative:hover {
  color: black;
}

/* Edit pencil icon */
.cr-fcv-chart-container.f3 .card_edit.pencil_icon {
  color: #fff;
  transition: 0.3s;
}

.cr-fcv-chart-container.f3 .card_edit.pencil_icon:hover {
  color: black;
}

/* Open note button on cards */
.cr-fcv-chart-container.f3 .cr-open-note-btn circle {
  fill: rgba(0, 0, 0, 0.4);
  stroke: rgba(255, 255, 255, 0.7);
  stroke-width: 1.5;
}

.cr-fcv-chart-container.f3 .cr-open-note-btn path {
  stroke: rgba(255, 255, 255, 0.9);
}

.cr-fcv-chart-container.f3 .cr-open-note-btn:hover circle {
  fill: rgba(0, 0, 0, 0.6);
  stroke: rgba(255, 255, 255, 0.9);
}

.cr-fcv-chart-container.f3 .cr-open-note-btn:hover path {
  stroke: #fff;
}

/* SVG Card avatar images */
.cr-fcv-chart-container.f3 .card_image {
  overflow: hidden;
}

.cr-fcv-chart-container.f3 .card_image image {
  /* Ensure avatar images render with rounded corners via clip-path */
  border-radius: 4px;
}

.cr-fcv-chart-container.f3 .card_image .genderless-icon rect {
  /* Fallback placeholder styling */
  rx: 4;
  ry: 4;
}

/* Connection lines */
.cr-fcv-chart-container.f3 .link {
  stroke: var(--text-color);
  stroke-width: 2px;
  fill: none;
  transition: stroke-width 0.2s ease-in-out;
}

.cr-fcv-chart-container.f3 .link.f3-path-to-main {
  stroke-width: 4px;
}

/* Kinship labels on links */
.cr-fcv-chart-container.f3 .cr-kinship-label {
  font-size: 10px;
  fill: var(--text-muted);
  pointer-events: none;
  font-weight: 500;
  opacity: 0.85;
}

.cr-fcv-chart-container.f3 .cr-kinship-label--spouse {
  fill: var(--text-normal);
  font-style: italic;
}

.cr-fcv-chart-container.f3 .cr-kinship-label--parent {
  fill: var(--text-muted);
}

.cr-fcv-chart-container.f3 .cr-kinship-label--numbered {
  font-size: 14px;
  font-style: normal;
  font-weight: 600;
  fill: var(--text-accent);
  opacity: 1;
}

/* ============================================================
 * HTML Card Styles (for HTML card mode)
 * ============================================================ */

.cr-fcv-chart-container.f3 div.card {
  cursor: pointer;
  color: var(--text-color);
  position: relative;
  line-height: 1.2;
}

.cr-fcv-chart-container.f3 div.card > div {
  transition: transform 0.2s ease-in-out;
  box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.8);
}

.cr-fcv-chart-container.f3 .card-inner {
  outline: 0 solid rgba(255, 255, 255, 1);
  transition: outline 0.5s ease-in-out;
}

.cr-fcv-chart-container.f3 div.card-female .card-inner,
.cr-fcv-chart-container.f3 div.card-female .person-icon svg {
  background-color: var(--female-color);
}

.cr-fcv-chart-container.f3 div.card-male .card-inner,
.cr-fcv-chart-container.f3 div.card-male .person-icon svg {
  background-color: var(--male-color);
}

.cr-fcv-chart-container.f3 div.card-genderless .card-inner,
.cr-fcv-chart-container.f3 div.card-genderless .person-icon svg {
  background-color: var(--genderless-color);
}

.cr-fcv-chart-container.f3 div.card:hover > div {
  transform: translate(0, -2px);
}

.cr-fcv-chart-container.f3 div.card-main .card-inner,
.cr-fcv-chart-container.f3 div.card:hover .card-inner {
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.8);
}

.cr-fcv-chart-container.f3 div.card-main .card-inner {
  outline: 4px solid rgba(220, 220, 220, 1);
}

.cr-fcv-chart-container.f3 div.card-inner.f3-path-to-main {
  outline: 4px solid rgba(255, 255, 255, 1);
}

/* Card image rect style */
.cr-fcv-chart-container.f3 div.card-image-rect {
  width: 200px;
  min-height: 70px;
  display: flex;
  align-items: center;
  border-radius: 5px;
}

.cr-fcv-chart-container.f3 div.card-image-rect .person-icon {
  height: 70px;
  width: 70px;
  object-fit: cover;
  flex: 0 0 auto;
  padding: 5px;
  margin-right: 10px;
}

.cr-fcv-chart-container.f3 div.card-image-rect img {
  height: 70px;
  width: 70px;
  object-fit: cover;
  flex: 0 0 auto;
  padding: 5px;
  margin-right: 10px;
  border-radius: 8px;
}

.cr-fcv-chart-container.f3 div.card-image-rect svg {
  object-fit: cover;
  width: 100%;
  height: 100%;
  padding: 5px;
  border-radius: 7px;
}

.cr-fcv-chart-container.f3 div.card-image-rect div.card-label {
  height: 100%;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

/* ============================================================
 * Form Container (Edit Tree)
 * ============================================================ */

.cr-fcv-chart-container.f3 .f3-form-cont {
  position: relative;
  z-index: 6;
  right: 0;
  top: 0;
  width: 0;
  height: 100%;
  background-color: var(--background-color);
  overflow: auto;
  flex: 0 0 auto;
  box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.5);
}

.cr-fcv-chart-container.f3 .f3-form-cont.opened {
  width: 350px;
}

/* Edit Mode Indicator */
.cr-fcv-chart-container.is-edit-mode {
  /* Subtle border to indicate edit mode is active */
  box-shadow: inset 0 0 0 2px var(--interactive-accent);
}

/* Form Styling */
.cr-fcv-chart-container.f3 .f3-form-cont form {
  padding: var(--size-4-3);
}

.cr-fcv-chart-container.f3 .f3-form-cont label {
  display: block;
  margin-bottom: var(--size-4-1);
  font-size: var(--font-ui-small);
  color: var(--text-muted);
}

.cr-fcv-chart-container.f3 .f3-form-cont input[type="text"],
.cr-fcv-chart-container.f3 .f3-form-cont input[type="date"],
.cr-fcv-chart-container.f3 .f3-form-cont select {
  width: 100%;
  padding: var(--size-4-1) var(--size-4-2);
  margin-bottom: var(--size-4-2);
  border: 1px solid var(--background-modifier-border);
  border-radius: var(--radius-s);
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: var(--font-ui-medium);
}

.cr-fcv-chart-container.f3 .f3-form-cont input:focus,
.cr-fcv-chart-container.f3 .f3-form-cont select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 2px var(--background-modifier-border-focus);
}

.cr-fcv-chart-container.f3 .f3-form-cont button {
  padding: var(--size-4-1) var(--size-4-3);
  margin-right: var(--size-4-2);
  margin-top: var(--size-4-2);
  border: none;
  border-radius: var(--radius-s);
  font-size: var(--font-ui-small);
  cursor: pointer;
  transition: all 0.1s ease;
}

.cr-fcv-chart-container.f3 .f3-form-cont button[type="submit"] {
  background-color: var(--interactive-accent);
  color: var(--text-on-accent);
}

.cr-fcv-chart-container.f3 .f3-form-cont button[type="submit"]:hover {
  background-color: var(--interactive-accent-hover);
}

.cr-fcv-chart-container.f3 .f3-form-cont button[type="button"] {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
}

.cr-fcv-chart-container.f3 .f3-form-cont button[type="button"]:hover {
  background-color: var(--background-modifier-active-hover);
}

/* Delete button */
.cr-fcv-chart-container.f3 .f3-form-cont button.delete-btn {
  background-color: transparent;
  color: var(--text-error);
}

.cr-fcv-chart-container.f3 .f3-form-cont button.delete-btn:hover {
  background-color: rgba(var(--color-red-rgb), 0.1);
}

/* Gender toggle switch */
.cr-fcv-chart-container.f3 .f3-form-cont .gender-switch {
  display: flex;
  gap: var(--size-4-2);
  margin-bottom: var(--size-4-2);
}

.cr-fcv-chart-container.f3 .f3-form-cont .gender-switch label {
  display: inline-flex;
  align-items: center;
  gap: var(--size-4-1);
  margin-bottom: 0;
  cursor: pointer;
}

/* Add relative buttons */
.cr-fcv-chart-container.f3 .f3-form-cont .add-relative-btns {
  display: flex;
  flex-wrap: wrap;
  gap: var(--size-4-1);
  margin-top: var(--size-4-3);
  padding-top: var(--size-4-3);
  border-top: 1px solid var(--background-modifier-border);
}

.cr-fcv-chart-container.f3 .f3-form-cont .add-relative-btns button {
  flex: 1;
  min-width: 80px;
  margin: 0;
}

/* Constrain SVG icons in form panel - force all SVGs to reasonable size */
.cr-fcv-chart-container.f3 .f3-form-cont svg {
  width: 24px !important;
  height: 24px !important;
  max-width: 24px !important;
  max-height: 24px !important;
  flex-shrink: 0;
}

.cr-fcv-chart-container.f3 .f3-form-cont button svg {
  width: 16px !important;
  height: 16px !important;
  max-width: 16px !important;
  max-height: 16px !important;
}

/* Form panel layout constraints */
.cr-fcv-chart-container.f3 .f3-form-cont {
  max-width: 350px;
}

.cr-fcv-chart-container.f3 .f3-form-cont > * {
  max-width: 100%;
  overflow: hidden;
}

/* Add relative action icons */
.cr-fcv-chart-container.f3 .f3-form-cont .add-rel-btn,
.cr-fcv-chart-container.f3 .f3-form-cont [class*="add-rel"],
.cr-fcv-chart-container.f3 .f3-form-cont [class*="add_rel"] {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  padding: var(--size-4-2);
  border-radius: var(--radius-s);
  background-color: var(--background-modifier-hover);
  cursor: pointer;
  transition: background-color 0.1s ease;
}

.cr-fcv-chart-container.f3 .f3-form-cont [class*="add-rel"]:hover,
.cr-fcv-chart-container.f3 .f3-form-cont [class*="add_rel"]:hover {
  background-color: var(--background-modifier-active-hover);
}

/* Form action buttons container */
.cr-fcv-chart-container.f3 .f3-form-cont > div {
  max-width: 350px;
}

/* ============================================================
 * Theme Adjustments
 * ============================================================ */

.theme-light .cr-fcv-chart-container.f3 {
  --background-color: var(--cr-fcv-background-light, rgb(250, 250, 250));
  --text-color: var(--cr-fcv-text-light, #333);
}

.theme-light .cr-fcv-chart-container.f3 .link {
  stroke: #666;
}

/* ============================================================
 * Responsive Adjustments
 * ============================================================ */

@media (max-width: 600px) {
  .cr-fcv-toolbar {
    flex-wrap: wrap;
    gap: var(--size-4-1);
  }

  .cr-fcv-toolbar-left,
  .cr-fcv-toolbar-right {
    flex-wrap: wrap;
  }

  .cr-fcv-label {
    display: none;
  }
}

/* ============================================================
 * Loading Overlay
 * Shown during initial chart positioning
 * ============================================================ */

.cr-family-chart-loading {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--size-4-3);
  background-color: var(--background-primary);
  z-index: 100;
}

.cr-family-chart-loading__spinner {
  width: 32px;
  height: 32px;
  border: 3px solid var(--background-modifier-border);
  border-top-color: var(--interactive-accent);
  border-radius: 50%;
  animation: cr-fcv-spin 0.8s linear infinite;
}

.cr-family-chart-loading__text {
  font-size: var(--font-ui-small);
  color: var(--text-muted);
}

@keyframes cr-fcv-spin {
  to {
    transform: rotate(360deg);
  }
}

/* ============================================================
 * Error State
 * Shown when chart initialization fails
 * ============================================================ */

.cr-family-chart-error {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  padding: var(--size-4-4);
  text-align: center;
  color: var(--text-muted);
}

.cr-family-chart-error h3 {
  margin: 0 0 var(--size-4-2);
  color: var(--text-error);
}

.cr-family-chart-error p {
  margin: 0;
}

/* ============================================================
 * Content Area (Chart + Info Panel)
 * ============================================================ */

.cr-fcv-content {
  display: flex;
  flex: 1;
  min-height: 0;
  overflow: hidden;
}

/* ============================================================
 * Info Panel
 * ============================================================ */

.cr-fcv-info-panel {
  width: 320px;
  min-width: 280px;
  max-width: 400px;
  display: flex;
  flex-direction: column;
  background-color: var(--background-secondary);
  border-left: 1px solid var(--background-modifier-border);
  flex-shrink: 0;
  overflow: hidden;
}

.cr-fcv-info-panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--size-4-3);
  border-bottom: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary-alt);
}

.cr-fcv-info-panel-title {
  font-size: var(--font-ui-medium);
  font-weight: var(--font-semibold);
  color: var(--text-normal);
  margin: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.cr-fcv-info-panel-close {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  padding: 0;
  border: none;
  border-radius: var(--radius-s);
  background: transparent;
  color: var(--text-muted);
  cursor: pointer;
  flex-shrink: 0;
}

.cr-fcv-info-panel-close:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
}

.cr-fcv-info-panel-close svg {
  width: 16px;
  height: 16px;
}

.cr-fcv-info-panel-content {
  flex: 1;
  overflow-y: auto;
  padding: var(--size-4-3);
}

.cr-fcv-info-panel-actions {
  display: flex;
  align-items: center;
  gap: var(--size-4-2);
  padding: var(--size-4-3);
  border-top: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary-alt);
}

.cr-fcv-info-panel-actions.view-mode {
  justify-content: space-between;
}

.cr-fcv-info-panel-actions.edit-mode {
  justify-content: flex-end;
}

.cr-fcv-info-panel-actions-description {
  flex: 1;
  font-size: var(--font-ui-smaller);
  color: var(--text-muted);
}

.cr-fcv-info-panel-actions-buttons {
  display: flex;
  gap: var(--size-4-2);
  flex-shrink: 0;
}

/* ============================================================
 * Info Panel Fields (View Mode)
 * ============================================================ */

.cr-fcv-info-field {
  display: flex;
  align-items: baseline;
  gap: var(--size-4-3);
  margin-bottom: var(--size-4-3);
  line-height: 1.5;
}

.cr-fcv-info-field-label {
  flex-shrink: 0;
  min-width: 70px;
  font-size: var(--font-ui-small);
  color: var(--text-muted);
}

.cr-fcv-info-field-value {
  flex: 1;
  font-size: var(--font-ui-small);
  color: var(--text-normal);
}

.cr-fcv-info-field-value.empty {
  color: var(--text-faint);
  font-style: italic;
}

/* ============================================================
 * Info Panel Fields (Edit Mode)
 * ============================================================ */

.cr-fcv-info-field-input {
  flex: 1;
  padding: var(--size-4-1) var(--size-4-2);
  border: 1px solid var(--background-modifier-border);
  border-radius: var(--radius-s);
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: var(--font-ui-small);
}

.cr-fcv-info-field-input:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 2px var(--background-modifier-border-focus);
}

.cr-fcv-info-field-input::placeholder {
  color: var(--text-faint);
}

.cr-fcv-info-field-select {
  flex: 1;
  padding: var(--size-4-1) var(--size-4-2);
  border: 1px solid var(--background-modifier-border);
  border-radius: var(--radius-s);
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: var(--font-ui-small);
}

.cr-fcv-info-field-select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 2px var(--background-modifier-border-focus);
}

/* ============================================================
 * Info Panel Relationships Section
 * ============================================================ */

.cr-fcv-info-panel-relationships {
  margin-top: var(--size-4-4);
  padding-top: var(--size-4-3);
  border-top: 1px solid var(--background-modifier-border);
}

.cr-fcv-info-panel-relationships h4 {
  font-size: var(--font-ui-small);
  font-weight: var(--font-semibold);
  color: var(--text-normal);
  margin: 0 0 var(--size-4-2) 0;
}

.cr-fcv-relationship-group {
  margin-bottom: var(--size-4-3);
}

.cr-fcv-relationship-group-label {
  font-size: var(--font-ui-smaller);
  color: var(--text-faint);
  margin-bottom: var(--size-4-1);
}

.cr-fcv-relationship-link {
  display: block;
  padding: var(--size-4-1) var(--size-4-2);
  margin-bottom: var(--size-4-1);
  border-radius: var(--radius-s);
  background-color: var(--background-primary);
  color: var(--text-normal);
  text-decoration: none;
  cursor: pointer;
  transition: background-color 0.1s ease;
}

.cr-fcv-relationship-link:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-accent);
}

.cr-fcv-relationship-link:last-child {
  margin-bottom: 0;
}

/* ============================================================
 * Info Panel Buttons
 * Use Obsidian's native button styles via the button element
 * Primary: add .mod-cta class
 * Secondary: plain button element
 * ============================================================ */

.cr-fcv-info-panel-actions button {
  /* Override flex behavior for action buttons */
  flex-shrink: 0;
}

/* ============================================================
 * Info Panel Responsive Adjustments
 * ============================================================ */

@media (max-width: 800px) {
  .cr-fcv-info-panel {
    width: 280px;
    min-width: 240px;
  }
}

@media (max-width: 600px) {
  .cr-fcv-content {
    flex-direction: column;
  }

  .cr-fcv-info-panel {
    width: 100%;
    max-width: none;
    min-width: 0;
    max-height: 50%;
    border-left: none;
    border-top: 1px solid var(--background-modifier-border);
  }
}

/* ============================================================
 * Style Modal (Color Customization)
 * ============================================================ */

.cr-fcv-style-modal {
  max-width: 400px;
}

.cr-fcv-style-modal .modal-content {
  padding: var(--size-4-4);
}

.cr-fcv-color-section {
  margin-bottom: var(--size-4-4);
}

.cr-fcv-color-section h3 {
  font-size: var(--font-ui-small);
  font-weight: var(--font-semibold);
  color: var(--text-normal);
  margin: 0 0 var(--size-4-2) 0;
  padding-bottom: var(--size-4-1);
  border-bottom: 1px solid var(--background-modifier-border);
}

.cr-fcv-color-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--size-4-2) 0;
}

.cr-fcv-color-row label {
  font-size: var(--font-ui-small);
  color: var(--text-normal);
}

.cr-fcv-color-input-container {
  display: flex;
  align-items: center;
  gap: var(--size-4-2);
}

.cr-fcv-color-input {
  width: 40px;
  height: 28px;
  padding: 0;
  border: 1px solid var(--background-modifier-border);
  border-radius: var(--radius-s);
  cursor: pointer;
  background: transparent;
}

.cr-fcv-color-input::-webkit-color-swatch-wrapper {
  padding: 2px;
}

.cr-fcv-color-input::-webkit-color-swatch {
  border-radius: var(--radius-s);
  border: none;
}

.cr-fcv-hex-display {
  font-family: var(--font-monospace);
  font-size: var(--font-ui-smaller);
  color: var(--text-muted);
  min-width: 70px;
}

.cr-fcv-presets-row {
  display: flex;
  flex-wrap: wrap;
  gap: var(--size-4-2);
  padding-top: var(--size-4-2);
}

.cr-fcv-preset-btn {
  padding: var(--size-4-1) var(--size-4-2);
  font-size: var(--font-ui-smaller);
  background-color: var(--background-modifier-hover);
  border: 1px solid var(--background-modifier-border);
  border-radius: var(--radius-s);
  cursor: pointer;
  transition: background-color 0.1s ease;
}

.cr-fcv-preset-btn:hover {
  background-color: var(--background-modifier-active-hover);
}

.cr-fcv-button-row {
  display: flex;
  align-items: center;
  gap: var(--size-4-2);
  padding-top: var(--size-4-4);
  margin-top: var(--size-4-2);
  border-top: 1px solid var(--background-modifier-border);
}

.cr-fcv-button-spacer {
  flex: 1;
}

.cr-fcv-btn-secondary {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
}

/* ============================================================
 * Card Style Options
 * CSS for different card visualization styles
 * ============================================================ */

/* ------------------------------------------------------------
 * Circular Avatar Card Styles
 * Used when cardStyle = 'circle'
 * Uses custom card HTML matching family-chart example structure
 * ------------------------------------------------------------ */

/* Circle card wrapper - matches family-chart v2 example */
/* Override Obsidian's base .card styles that add padding/margin */
.cr-fcv-chart-container.card-style-circle .card {
  cursor: pointer;
  pointer-events: auto;
  color: #fff;
  position: relative;
  /* Center the card on the node position */
  transform: translate(-50%, -50%);
  /* Reset Obsidian's .card defaults */
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  padding: 0 !important;
  margin: 0 !important;
  border-radius: 0 !important;
  display: block !important;
  flex-direction: unset !important;
  flex-grow: unset !important;
}

/* Override base hover transform that would shift card children */
.cr-fcv-chart-container.card-style-circle.f3 div.card:hover > div {
  /* Don't use translate - circle cards handle hover with scale on inner element */
}

/* Circular image card container */
.cr-fcv-chart-container.card-style-circle div.card-image {
  border-radius: 50%;
  padding: 5px;
  width: 90px;
  height: 90px;
  position: relative;
  box-sizing: border-box;
}

/* Label below circular cards - positioned to not affect card width */
.cr-fcv-chart-container.card-style-circle div.card-image div.card-label {
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-top: 5px;
  width: max-content;
  max-width: 200px;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.6);
  color: #fff;
  border-radius: 3px;
  padding: 4px 8px;
  font-size: 12px;
  line-height: 1.3;
}

/* Image styling for circular cards */
.cr-fcv-chart-container.card-style-circle div.card-image img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
}

/* Text-only card fallback (no avatar) */
.cr-fcv-chart-container.card-style-circle div.card-text {
  padding: 5px;
  border-radius: 3px;
  width: 120px;
  height: 70px;
  overflow: hidden;
  line-height: 1.2;
}

/* Hover effect - apply to inner card-image/card-text, not the .card wrapper */
.cr-fcv-chart-container.card-style-circle div.card > div {
  transition: transform 0.2s ease-in-out;
}

.cr-fcv-chart-container.card-style-circle div.card:hover > div {
  transform: scale(1.1);
}

/* Main card highlight - apply scale to inner element, shadow to card-image */
.cr-fcv-chart-container.card-style-circle div.card .card-main {
  transform: scale(1.05);
}

.cr-fcv-chart-container.card-style-circle div.card .card-main.card-image {
  box-shadow: 0 0 15px 0 rgba(0, 0, 0, 0.6);
}

/* Gender-based background colors */
.cr-fcv-chart-container.card-style-circle div.card-female {
  background-color: rgb(196, 138, 146);
}
.cr-fcv-chart-container.card-style-circle div.card-male {
  background-color: rgb(120, 159, 172);
}
.cr-fcv-chart-container.card-style-circle div.card-genderless {
  background-color: lightgray;
}

/* ------------------------------------------------------------
 * Compact Card Styles (text-only, no avatars)
 * Used when cardStyle = 'compact'
 * ------------------------------------------------------------ */

.cr-fcv-chart-container.card-style-compact rect.card-bg {
  width: 180px;
  height: 50px;
}

.cr-fcv-chart-container.card-style-compact text {
  font-size: 11px;
}

/* ------------------------------------------------------------
 * Mini Card Styles (smaller for overview)
 * Used when cardStyle = 'mini'
 * ------------------------------------------------------------ */

.cr-fcv-chart-container.card-style-mini rect.card-bg {
  width: 120px;
  height: 35px;
}

.cr-fcv-chart-container.card-style-mini text {
  font-size: 10px;
}

/* Hide "Open note" button on mini cards - too small */
.cr-fcv-chart-container.card-style-mini .open-note-btn {
  display: none;
}
